<div style="max-width: 900px; margin: 0 auto">
  <h2 style="text-align: center; color: #2563eb; margin-bottom: 1.5rem">
    Livros Disponíveis para Aluguel
  </h2>
  <div
    id="livros-usuario"
    style="
      margin-bottom: 1.5rem;
      font-size: 1.1rem;
      color: #2563eb;
      text-align: center;
    "
  ></div>
  <table class="users-table" id="livros-table">
    <thead>
      <tr>
        <th>Título</th>
        <th>Autor</th>
        <th>Categoria</th>
        <th>Data de Lançamento</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <!-- Livros serão renderizados pelo JS -->
    </tbody>
  </table>
  <hr style="margin: 2rem 0" />
  <h2 style="text-align: center; color: #2563eb; margin-bottom: 1.5rem">
    Relatório de Livros Alugados
  </h2>
  <div id="relatorio-alugados"></div>
</div>
<script>
  // Dados dos livros
  const livros = [
    {
      titulo: "Algoritmos e Lógica de Programação",
      autor: "Norton Trevisan",
      categoria: "TI",
      lancamento: "2017",
    },
    {
      titulo: "Psicologia para Programadores",
      autor: "Carlos Souza",
      categoria: "Psicologia",
      lancamento: "2019",
    },
    {
      titulo: "Matemática Discreta",
      autor: "Kenneth Rosen",
      categoria: "Matemática",
      lancamento: "2012",
    },
    {
      titulo: "Literatura Brasileira",
      autor: "Machado de Assis",
      categoria: "Literatura",
      lancamento: "1881",
    },
    {
      titulo: "História da Computação",
      autor: "Martin Campbell-Kelly",
      categoria: "História",
      lancamento: "2003",
    },
    {
      titulo: "Engenharia de Software",
      autor: "Ian Sommerville",
      categoria: "TI",
      lancamento: "2015",
    },
    {
      titulo: "Psicologia das Relações Humanas",
      autor: "Ana Beatriz Barbosa",
      categoria: "Psicologia",
      lancamento: "2020",
    },
    {
      titulo: "Matemática Financeira",
      autor: "José Dutra",
      categoria: "Matemática",
      lancamento: "2016",
    },
    {
      titulo: "Grandes Obras da Literatura",
      autor: "Clarice Lispector",
      categoria: "Literatura",
      lancamento: "1977",
    },
    {
      titulo: "História Geral",
      autor: "Mary Del Priore",
      categoria: "História",
      lancamento: "2010",
    },
  ];

  // Recupera usuário selecionado
  const clientes = JSON.parse(localStorage.getItem("clientes") || "[]");
  const clienteIndex = localStorage.getItem("clienteSelecionado");
  const usuario = clientes[clienteIndex];

  // Exibe usuário
  const usuarioDiv = document.getElementById("livros-usuario");
  usuarioDiv.innerHTML = usuario
    ? `Usuário: <strong>${usuario.nome}</strong> (${usuario.cpf})`
    : "Usuário não identificado.";

  // Renderiza tabela de livros
  function renderLivros() {
    const tbody = document.querySelector("#livros-table tbody");
    tbody.innerHTML = "";
    livros.forEach((livro, i) => {
      tbody.innerHTML += `
        <tr>
          <td>${livro.titulo}</td>
          <td>${livro.autor}</td>
          <td>${livro.categoria}</td>
          <td>${livro.lancamento}</td>
          <td>
            <button class="action-btn rent-btn" onclick="alugarLivroParaUsuario(${i})">Alugar</button>
          </td>
        </tr>
      `;
    });
  }

  // Função para alugar livro
  window.alugarLivroParaUsuario = function (livroIndex) {
    if (!usuario) return alert("Usuário não identificado.");
    const alugados = JSON.parse(localStorage.getItem("livrosAlugados") || "[]");
    alugados.push({
      usuario: usuario.nome,
      cpf: usuario.cpf,
      livro: livros[livroIndex].titulo,
      autor: livros[livroIndex].autor,
      categoria: livros[livroIndex].categoria,
      lancamento: livros[livroIndex].lancamento,
      data: new Date().toLocaleDateString(),
    });
    localStorage.setItem("livrosAlugados", JSON.stringify(alugados));
    renderRelatorio();
    alert(`Livro "${livros[livroIndex].titulo}" alugado para ${usuario.nome}!`);
  };

  // Relatório de livros alugados
  function renderRelatorio() {
    const relatorioDiv = document.getElementById("relatorio-alugados");
    const alugados = JSON.parse(localStorage.getItem("livrosAlugados") || "[]");
    if (alugados.length === 0) {
      relatorioDiv.innerHTML = "<p>Nenhum livro alugado.</p>";
      return;
    }
    let html = `<table class="users-table">
      <thead>
        <tr>
          <th>Usuário</th>
          <th>CPF</th>
          <th>Livro</th>
          <th>Autor</th>
          <th>Categoria</th>
          <th>Lançamento</th>
          <th>Data do Aluguel</th>
        </tr>
      </thead>
      <tbody>`;
    alugados.forEach((a) => {
      html += `<tr>
        <td>${a.usuario}</td>
        <td>${a.cpf}</td>
        <td>${a.livro}</td>
        <td>${a.autor}</td>
        <td>${a.categoria}</td>
        <td>${a.lancamento}</td>
        <td>${a.data}</td>
      </tr>`;
    });
    html += `</tbody></table>`;
    relatorioDiv.innerHTML = html;
  }

  renderLivros();
  renderRelatorio();
</script>
